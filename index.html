<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Battle Royale Prototype</title>

<style>
    body {
        margin:0;
        background:#0d0f1a;
        font-family:Arial;
        overflow:hidden;
        color:white;
    }

    /* --- LOBBY --- */
    #lobby {
        padding:40px;
    }
    #lobby h1 {
        font-size:40px;
        margin-bottom:10px;
    }
    .mode-btn {
        padding:12px 25px;
        margin:6px;
        background:#1d2233;
        border:1px solid #666;
        cursor:pointer;
        display:inline-block;
        border-radius:6px;
    }
    .mode-btn:hover {
        background:#29314a;
    }
    #readyBtn {
        margin-top:30px;
        padding:15px 40px;
        font-size:24px;
        background:#00aaff;
        border-radius:8px;
        cursor:pointer;
        display:inline-block;
    }

    /* --- GAME & MAP --- */
    #game {
        display:none;
        width:100vw;
        height:100vh;
        position:relative;
        background:black;
        overflow:hidden;
    }

    #map {
        width:3000px;
        height:3000px;
        background:#3ea34d;
        position:absolute;
        left:0;
        top:0;
    }

    .player {
        width:30px;
        height:30px;
        background:yellow;
        border-radius:4px;
        position:absolute;
    }

    .zone {
        position:absolute;
        border:4px solid #4affff;
        border-radius:50%;
        pointer-events:none;
    }

    .chest {
        width:25px;
        height:25px;
        background:orange;
        border-radius:4px;
        position:absolute;
        cursor:pointer;
    }

    #lootBox {
        position:fixed;
        bottom:20px;
        left:50%;
        transform:translateX(-50%);
        background:#000a;
        padding:15px 25px;
        border-radius:8px;
        display:none;
        font-size:20px;
    }
</style>
</head>

<body>

<!-- LOBBY -->
<div id="lobby">
    <h1>Battle Royale – Lobby</h1>
    <h3>Sélection du mode :</h3>

    <div class="mode-btn" onclick="selectMode('SOLO')">Solo</div>
    <div class="mode-btn" onclick="selectMode('DUO')">Duo</div>
    <div class="mode-btn" onclick="selectMode('SECTION')">Section</div>

    <h3 id="modeText">Mode choisi : Aucun</h3>

    <div id="readyBtn" onclick="startGame()">PRÊT</div>
</div>


<!-- GAME -->
<div id="game">
    <div id="map"></div>
    <div id="lootBox"></div>
</div>


<script>
/* ------- LOBBY -------- */

let selectedMode = "";

function selectMode(m) {
    selectedMode = m;
    document.getElementById("modeText").innerText = "Mode choisi : " + m;
}

function startGame() {
    if(selectedMode === "") {
        alert("Choisis un mode !");
        return;
    }
    document.getElementById("lobby").style.display="none";
    document.getElementById("game").style.display="block";

    initGame();
}


/* ------- GAME INIT -------- */

let player = {
    x:1500,
    y:1500,
    speed:6,
    el:null
};

let keys = {};

let zoneSize = 2000;
let zonePhase = 1;
let maxPhase = 8;
let zoneDamage = 1;

let weapons = ["SCAR", "SPAS‑12", "FAMAS", "Pistolet", "SMG", "Sniper"];


function initGame() {

    document.onkeydown = e => keys[e.key.toLowerCase()] = true;
    document.onkeyup   = e => keys[e.key.toLowerCase()] = false;

    spawnPlayer();
    spawnChests(80);
    startZone();

    gameLoop();
}


/* ------- PLAYER -------- */

function spawnPlayer() {
    let p = document.createElement("div");
    p.className = "player";
    document.getElementById("map").appendChild(p);
    player.el = p;
}


/* ------- GAME LOOP -------- */

function gameLoop() {

    if(keys["z"]) player.y -= player.speed;
    if(keys["s"]) player.y += player.speed;
    if(keys["q"]) player.x -= player.speed;
    if(keys["d"]) player.x += player.speed;

    player.el.style.left = player.x + "px";
    player.el.style.top  = player.y + "px";

    checkZoneDamage();

    requestAnimationFrame(gameLoop);
}


/* ------- ZONE -------- */

function startZone() {
    let z = document.createElement("div");
    z.id = "zone";
    z.className = "zone";
    document.getElementById("map").appendChild(z);

    updateZone();
}

function updateZone() {
    let z = document.getElementById("zone");

    z.style.width = zoneSize + "px";
    z.style.height = zoneSize + "px";
    z.style.left = (1500 - zoneSize/2) + "px";
    z.style.top  = (1500 - zoneSize/2) + "px";

    if(zonePhase <= 3) zoneDamage = 1;
    else if(zonePhase <= 5) zoneDamage = 2;
    else zoneDamage = 5;

    if(zonePhase < maxPhase) {
        zoneSize -= 250;
        zonePhase++;
        setTimeout(updateZone, 8000);
    }
}

function checkZoneDamage() {
    let d = Math.sqrt(
        (player.x - 1500)**2 +
        (player.y - 1500)**2
    );

    if(d > zoneSize/2) {
        console.log("Dégâts de zone : -" + zoneDamage);
    }
}


/* ------- CHESTS -------- */

function spawnChests(n) {
    for(let i=0;i<n;i++) {
        let c = document.createElement("div");
        c.className = "chest";
        c.style.left = Math.random()*2950 + "px";
        c.style.top  = Math.random()*2950 + "px";
        c.onclick = () => openChest(c);
        document.getElementById("map").appendChild(c);
    }
}


function openChest(c) {
    let loot = weapons[Math.floor(Math.random()*weapons.length)];
    let box = document.getElementById("lootBox");
    box.innerText = "Trouvé : " + loot;
    box.style.display = "block";
    setTimeout(() => box.style.display="none", 1500);

    c.remove();
}
</script>

</body>
</html>
